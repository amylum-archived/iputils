diff --git a/arping.c b/arping.c
index 1a3f40b..531d29d 100644
--- a/arping.c
+++ b/arping.c
@@ -45,6 +45,13 @@ struct sysfs_devattr_values;
 #ifdef USE_IDN
 #include <idna.h>
 #include <locale.h>
+
+#ifndef AI_IDN
+#define AI_IDN 0x0040
+#endif
+#ifndef AI_CANONIDN
+#define AI_CANONIDN 0x0080
+#endif
 #endif
 
 #include "SNAPSHOT.h"
diff --git a/ping.h b/ping.h
index 749f3ff..227315f 100644
--- a/ping.h
+++ b/ping.h
@@ -38,6 +38,17 @@
 #include <locale.h>
 #include <idna.h>
 #include <stringprep.h>
+
+#ifndef AI_IDN
+#define AI_IDN 0x0040
+#endif
+#ifndef AI_CANONIDN
+#define AI_CANONIDN 0x0080
+#endif
+#ifndef NI_IDN
+#define NI_IDN 32
+#endif
+
 #define getaddrinfo_flags (AI_CANONNAME | AI_IDN | AI_CANONIDN)
 #define getnameinfo_flags NI_IDN
 #else
diff --git a/tracepath.c b/tracepath.c
index 74a829d..c49f0c2 100644
--- a/tracepath.c
+++ b/tracepath.c
@@ -29,6 +29,16 @@
 
 #ifdef USE_IDN
 #include <idna.h>
+#ifndef AI_IDN
+#define AI_IDN 0x0040
+#endif
+#ifndef AI_CANONIDN
+#define AI_CANONIDN 0x0080
+#endif
+#ifndef NI_IDN
+#define NI_IDN 32
+#endif
+
 #include <locale.h>
 #define getnameinfo_flags	NI_IDN
 #else
diff -Naur iputils-s20150815.orig/traceroute6.c iputils-s20150815/traceroute6.c
--- iputils-s20150815.orig/traceroute6.c	2015-08-15 07:07:28.000000000 -0700
+++ iputils-s20150815/traceroute6.c	2016-03-12 14:19:00.839370696 -0800
@@ -250,6 +250,10 @@
 #include <idna.h>
 #include <locale.h>
 
+#ifndef NI_IDN
+#define NI_IDN 32
+#endif
+
 #define getnameinfo_flags	NI_IDN
 #else
 #define getnameinfo_flags	0
